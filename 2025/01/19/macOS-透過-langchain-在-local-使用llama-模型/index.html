<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>macOS 透過 langchain 在 local 使用llama 模型 | Jed學習筆記</title><meta name="author" content="Jed Hung"><meta name="copyright" content="Jed Hung"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="macOS local 使用llama模型筆記">
<meta property="og:type" content="article">
<meta property="og:title" content="macOS 透過 langchain 在 local 使用llama 模型">
<meta property="og:url" content="http://example.com/2025/01/19/macOS-%E9%80%8F%E9%81%8E-langchain-%E5%9C%A8-local-%E4%BD%BF%E7%94%A8llama-%E6%A8%A1%E5%9E%8B/index.html">
<meta property="og:site_name" content="Jed學習筆記">
<meta property="og:description" content="macOS local 使用llama模型筆記">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/MQ68T61TJP7ZWGBENS27X17RV0.jpeg">
<meta property="article:published_time" content="2025-01-19T13:42:47.018Z">
<meta property="article:modified_time" content="2025-12-14T13:01:44.211Z">
<meta property="article:author" content="Jed Hung">
<meta property="article:tag" content="LLM">
<meta property="article:tag" content="Python">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/MQ68T61TJP7ZWGBENS27X17RV0.jpeg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "macOS 透過 langchain 在 local 使用llama 模型",
  "url": "http://example.com/2025/01/19/macOS-%E9%80%8F%E9%81%8E-langchain-%E5%9C%A8-local-%E4%BD%BF%E7%94%A8llama-%E6%A8%A1%E5%9E%8B/",
  "image": "https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/MQ68T61TJP7ZWGBENS27X17RV0.jpeg",
  "datePublished": "2025-01-19T13:42:47.018Z",
  "dateModified": "2025-12-14T13:01:44.211Z",
  "author": [
    {
      "@type": "Person",
      "name": "Jed Hung",
      "url": "http://example.com"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2025/01/19/macOS-%E9%80%8F%E9%81%8E-langchain-%E5%9C%A8-local-%E4%BD%BF%E7%94%A8llama-%E6%A8%A1%E5%9E%8B/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.3"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'macOS 透過 langchain 在 local 使用llama 模型',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.1.1"></head><body><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/MQ68T61TJP7ZWGBENS27X17RV0.jpeg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Jed學習筆記</span></a><a class="nav-page-title" href="/"><span class="site-name">macOS 透過 langchain 在 local 使用llama 模型</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"></div></nav><div id="post-info"><h1 class="post-title">macOS 透過 langchain 在 local 使用llama 模型</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-01-19T13:42:47.018Z" title="Created 2025-01-19 21:42:47">2025-01-19</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-12-14T13:01:44.211Z" title="Updated 2025-12-14 21:01:44">2025-12-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/AI/">AI</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/AI/LLM/">LLM</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="macOS-透過-langchain-在-local-使用llama-模型"><a href="#macOS-透過-langchain-在-local-使用llama-模型" class="headerlink" title="macOS 透過 langchain 在 local 使用llama 模型"></a>macOS 透過 langchain 在 local 使用llama 模型</h1><h2 id="step1-下載模型"><a href="#step1-下載模型" class="headerlink" title="step1. 下載模型"></a>step1. 下載模型</h2><p><a target="_blank" rel="noopener" href="https://huggingface.co/TheBloke/Llama-2-7B-Chat-GGUF/tree/main">https://huggingface.co/TheBloke/Llama-2-7B-Chat-GGUF/tree/main</a><br>前往huggingface下載模型llama-2-7b-chat.Q4_0.gguf，可能要先與專案管理者授權需等待一點時間(約半天內就能過審)</p>
<h2 id="step2-安裝Metal-GPU-MacOS-conda版本版本"><a href="#step2-安裝Metal-GPU-MacOS-conda版本版本" class="headerlink" title="step2 安裝Metal GPU MacOS conda版本版本"></a>step2 安裝Metal GPU MacOS conda版本版本</h2><h3 id="安裝xcode"><a href="#安裝xcode" class="headerlink" title="安裝xcode"></a>安裝xcode</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># check the path of your xcode install </span></span><br><span class="line">xcode-select -p</span><br><span class="line"></span><br><span class="line"><span class="comment"># xcode installed returns</span></span><br><span class="line"><span class="comment"># /Applications/Xcode-beta.app/Contents/Developer</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># if xcode is missing then install it... it takes ages;</span></span><br><span class="line">xcode-select --install</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="安裝conda"><a href="#安裝conda" class="headerlink" title="安裝conda"></a>安裝conda</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/conda-forge/miniforge/releases/latest/download/Miniforge3-MacOSX-arm64.sh</span><br><span class="line">bash Miniforge3-MacOSX-arm64.sh</span><br></pre></td></tr></table></figure>

<h3 id="建置conda環境"><a href="#建置conda環境" class="headerlink" title="建置conda環境"></a>建置conda環境</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conda create -n llama python=3.9.16</span><br><span class="line">conda activate llama</span><br></pre></td></tr></table></figure>


<h3 id="建立專案"><a href="#建立專案" class="headerlink" title="建立專案"></a>建立專案</h3><p>安裝library</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pip install langchain</span><br><span class="line">pip install langchain-community</span><br><span class="line">pip install llama-cpp-python</span><br><span class="line">pip install faiss-gpu</span><br><span class="line">pip install pypdf</span><br></pre></td></tr></table></figure>

<p>程式碼</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.chains.api.openapi <span class="keyword">import</span> chain</span><br><span class="line"><span class="keyword">from</span> langchain.chains.retrieval_qa.base <span class="keyword">import</span> RetrievalQA</span><br><span class="line"><span class="keyword">from</span> langchain_community.document_loaders <span class="keyword">import</span> DirectoryLoader, PyPDFLoader</span><br><span class="line"><span class="keyword">from</span> langchain_community.llms <span class="keyword">import</span> LlamaCpp</span><br><span class="line"><span class="keyword">from</span> langchain.prompts <span class="keyword">import</span> PromptTemplate</span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> LLMChain</span><br><span class="line"><span class="keyword">from</span> langchain.embeddings <span class="keyword">import</span> LlamaCppEmbeddings</span><br><span class="line"><span class="keyword">from</span> langchain_community.llms <span class="keyword">import</span> Ollama</span><br><span class="line"><span class="keyword">from</span> langchain_core.documents <span class="keyword">import</span> Document</span><br><span class="line"><span class="keyword">from</span> langchain.text_splitter <span class="keyword">import</span> CharacterTextSplitter</span><br><span class="line"><span class="keyword">from</span> langchain_community.embeddings <span class="keyword">import</span> OllamaEmbeddings</span><br><span class="line"><span class="keyword">from</span> langchain_community.vectorstores <span class="keyword">import</span> FAISS</span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate</span><br><span class="line"><span class="keyword">from</span> langchain.chains.combine_documents <span class="keyword">import</span> create_stuff_documents_chain</span><br><span class="line"><span class="keyword">from</span> langchain.chains <span class="keyword">import</span> create_retrieval_chain</span><br><span class="line"><span class="keyword">from</span> langchain_text_splitters <span class="keyword">import</span> RecursiveCharacterTextSplitter</span><br><span class="line"></span><br><span class="line">path = <span class="string">&#x27;llama-2-7b-chat.Q8_0.gguf&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LlamaCppEmbeddings_</span>(<span class="title class_ inherited__">LlamaCppEmbeddings</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">embed_documents</span>(<span class="params">self, texts: <span class="built_in">list</span>[<span class="built_in">str</span>]</span>) -&gt; <span class="built_in">list</span>[<span class="built_in">list</span>[<span class="built_in">float</span>]]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Embed a list of documents using the Llama model.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            texts: The list of texts to embed.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            List of embeddings, one for each text.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        embeddings = [<span class="variable language_">self</span>.client.embed(text)[<span class="number">0</span>] <span class="keyword">for</span> text <span class="keyword">in</span> texts]</span><br><span class="line">        <span class="keyword">return</span> [<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">float</span>, e)) <span class="keyword">for</span> e <span class="keyword">in</span> embeddings]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">embed_query</span>(<span class="params">self, text: <span class="built_in">str</span></span>) -&gt; <span class="built_in">list</span>[<span class="built_in">float</span>]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Embed a query using the Llama model.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            text: The text to embed.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            Embeddings for the text.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        embedding = <span class="variable language_">self</span>.client.embed(text)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">float</span>, embedding))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># Load the LlamaCpp language model, adjust GPU usage based on your hardware</span></span><br><span class="line">    llm = LlamaCpp(</span><br><span class="line">        model_path=path,</span><br><span class="line">        n_gpu_layers=<span class="number">40</span>,</span><br><span class="line">        n_batch=<span class="number">512</span>,  <span class="comment"># Batch size for model processing</span></span><br><span class="line">        verbose=<span class="literal">False</span>,  <span class="comment"># Enable detailed logging for debugging</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Define the prompt template with a placeholder for the question</span></span><br><span class="line">    template = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Question: &#123;question&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Answer:</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    prompt = PromptTemplate(template=template, input_variables=[<span class="string">&quot;question&quot;</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Create an LLMChain to manage interactions with the prompt and model</span></span><br><span class="line">    llm_chain = LLMChain(prompt=prompt, llm=llm)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Chatbot initialized, ready to chat...&quot;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        question = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line">        answer = llm_chain.run(question)</span><br><span class="line">        <span class="built_in">print</span>(answer, <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    llm = LlamaCpp(</span><br><span class="line">        model_path=path,</span><br><span class="line">        temperature=<span class="number">0.4</span>,</span><br><span class="line">        max_new_tokens=<span class="number">256</span>,</span><br><span class="line">        context_window=<span class="number">2048</span>,</span><br><span class="line">        n_batch=<span class="number">1100</span>,  <span class="comment"># Batch size for model processing</span></span><br><span class="line">        n_ctx=<span class="number">1100</span>,</span><br><span class="line">        n_ubatch=<span class="number">1100</span>,</span><br><span class="line">        verbose=<span class="literal">True</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    loader = DirectoryLoader(</span><br><span class="line">        <span class="string">&#x27;D:\python_program\pythonProject\Auth&#x27;</span>,</span><br><span class="line">        glob=<span class="string">&#x27;*.pdf&#x27;</span>,</span><br><span class="line">        loader_cls=PyPDFLoader</span><br><span class="line">    )</span><br><span class="line">    documents = loader.load()</span><br><span class="line"></span><br><span class="line">    text_splitter = RecursiveCharacterTextSplitter(</span><br><span class="line">        chunk_size=<span class="number">110</span>,  <span class="comment"># 更小的块以减少上下文大小</span></span><br><span class="line">        chunk_overlap=<span class="number">10</span>  <span class="comment"># 适当的重叠可以帮助保持语义连贯性</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    splits = text_splitter.split_documents(documents)</span><br><span class="line"></span><br><span class="line">    embeddings = LlamaCppEmbeddings_(model_path=path)</span><br><span class="line"></span><br><span class="line">    vectorstore = FAISS.from_documents(</span><br><span class="line">        documents=splits,</span><br><span class="line">        embedding=embeddings,</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    retriever = vectorstore.as_retriever(search_kwargs=&#123;<span class="string">&quot;k&quot;</span>: <span class="number">3</span>&#125;) </span><br><span class="line"></span><br><span class="line">    <span class="comment"># QA template </span></span><br><span class="line">    template = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Question: &#123;question&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Answer:</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    prompt = PromptTemplate(template=template, input_variables=[<span class="string">&quot;question&quot;</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># create chain</span></span><br><span class="line">    llm_chain = LLMChain(prompt=prompt, llm=llm)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Chatbot initialized, ready to chat...&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        question = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># query</span></span><br><span class="line">        results = retriever.get_relevant_documents(question)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 控制字數以免超過上限</span></span><br><span class="line">        combined_context = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> result <span class="keyword">in</span> results:</span><br><span class="line">            combined_context += result.page_content + <span class="string">&quot;\n&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># prompt</span></span><br><span class="line">        full_prompt = <span class="string">f&quot;Question: <span class="subst">&#123;question&#125;</span>\n\nContext: <span class="subst">&#123;combined_context&#125;</span>\n\nAnswer:<span class="subst">&#123;combined_context&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 生成回答</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            response = llm_chain.run(question=full_prompt)</span><br><span class="line">            <span class="built_in">print</span>(response)</span><br><span class="line">        <span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Error: <span class="subst">&#123;e&#125;</span>\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>參考文獻：<br><a target="_blank" rel="noopener" href="https://huggingface.co/TheBloke/CodeLlama-7B-GGUF/tree/main">https://huggingface.co/TheBloke/CodeLlama-7B-GGUF/tree/main</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="http://example.com">Jed Hung</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="http://example.com/2025/01/19/macOS-%E9%80%8F%E9%81%8E-langchain-%E5%9C%A8-local-%E4%BD%BF%E7%94%A8llama-%E6%A8%A1%E5%9E%8B/">http://example.com/2025/01/19/macOS-%E9%80%8F%E9%81%8E-langchain-%E5%9C%A8-local-%E4%BD%BF%E7%94%A8llama-%E6%A8%A1%E5%9E%8B/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Python/">Python</a><a class="post-meta__tags" href="/tags/LLM/">LLM</a></div><div class="post-share"><div class="social-share" data-image="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/MQ68T61TJP7ZWGBENS27X17RV0.jpeg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/01/19/%E5%9F%BA%E7%A4%8E%E6%9E%B6%E6%A7%8B%E5%8D%B3%E7%A8%8B%E5%BC%8F%E7%A2%BC-IaC/" title="基礎架構即程式碼(IaC)"><img class="cover" src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/MQ68T61TJP7ZWGBENS27X17RV0.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">基礎架構即程式碼(IaC)</div></div><div class="info-2"><div class="info-item-1">Infrastructure as Code IaC基礎架構即程式碼(IaC)基礎建設即程式碼（Infrastructure as Code, IaC） 是一種強化 DevOps持續交付軟體品質與版本控制的技術，透過描述性的模型來定義與部署基礎建設資源，例如以下：  net   vm   api gateway   cdn   serverless fcuntion  IaC把煩雜的設置抽象出來，且用讓人看得懂的設置使得部署更好維護，以及快速拓展應用程式無需一一設置，直接實際舉個例子： 需求如下建立一個簡單的 HTTP API，當訪問 &#x2F;greet&#x2F;{name} 時返回一個問候語。使用 AWS Lambda 提供業務邏輯，並通過 API Gateway 提供 HTTP 端點。 首先需要寫個python lambda 123456789import osdef greet(event, context):    name = event[&quot;pathParameters&quot;].get(&quot;name&quot;, &quot;Strange...</div></div></div></a><a class="pagination-related" href="/2025/01/19/Python-Property/" title="Python Property"><img class="cover" src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/MQ68T61TJP7ZWGBENS27X17RV0.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Python Property</div></div><div class="info-2"><div class="info-item-1">propertyproperty 是一種用來管理對象屬性訪問的機制。它允許你使用方法來管理屬性讀取、寫入和刪除，而不需要直接調用方法。這樣做可以使屬性操作更直觀，並提供更多的控制和封裝，而在python中所有property都是public，可以透過以下例子來驗證 例子 school為內部會使用的property 1234567891011class Student(object):    def __init__(self, name, age, school):        self.name = name        self.age = age        self._school = schoolstudent_info = Student(name=&#x27;Jed&#x27;, age=18, school=&#x27;Python_School&#x27;) property皆public，可以看到student_info.__dict__能看到_school property 1234print(student_info.__dict__)&gt;&gt...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/01/19/Python-%E6%8E%A8%E5%B0%8E%E5%BC%8F-Comprehension-%E8%88%87%E8%B3%A6%E5%80%BC%E8%A1%A8%E9%81%94%E5%BC%8F-Walrus-Operator/" title="Python 推導式(Comprehension)與賦值表達式(Walrus Operator)"><img class="cover" src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/MQ68T61TJP7ZWGBENS27X17RV0.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-19</div><div class="info-item-2">Python 推導式(Comprehension)與賦值表達式(Walrus Operator)</div></div><div class="info-2"><div class="info-item-1">Comprehension與Walrus Operator推導式(comprehension)推導式是python獨有的方法可簡潔for loop，來看例子 正常情況for loop list123456greater_than_five = []numbers = [1,2,3,4,5,6,7,8,9,10]for number in numbers:    if number &gt; 5:        greater_than_five.append(number) 從程式中簡單的邏輯卻不太簡潔，我們可以漂亮的改用推導式 123456numbers = [1,2,3,4,5,6,7,8,9,10]greater_than_five= [n for n in numbers                     if n &gt; 5]print(greater_than_five)&gt;&gt; [6, 7, 8, 9, 10] 推導式好處在將結果賦予變數，不須再for loop外層宣告變數，也不用再用append加入list，簡潔了程式 dict123456numb...</div></div></div></a><a class="pagination-related" href="/2025/01/19/Python-Context-manager/" title="Python Context manager"><img class="cover" src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/MQ68T61TJP7ZWGBENS27X17RV0.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-19</div><div class="info-item-2">Python Context manager</div></div><div class="info-2"><div class="info-item-1">Python Context manager上下文管理器（Context Manager）在 Python 中，上下文管理器是一種自動管理資源的工具，能幫助我們確保在使用完資源後進行適當的清理。中文有一句成語叫「前因後果」，我們可以用這個成語來形象地解釋上下文管理器的作用。 例子 假設今天老闆要求你用財務上半季的營收 Excel 檔案視覺化為長條圖。要完成這個任務，我們首先需要讀取 Excel 檔案。這裡，我們可以使用上下文管理器來處理檔案的打開和關閉。  前因：因為需要處理某個資源（如打開文件），所以我們寫了一段代碼來操作這個資源。 後果：當代碼執行完畢後，需要進行一些清理工作（如關閉文件），這樣可以確保資源被正確地釋放。  例子1 1234567# 上下文管理器示例excel_file = open(&#x27;202401.csv&#x27;)  # 上文 (前因)try:    excel_to_bar_chart(excel_file)finally:    excel_file.close()  # 下文 (後果)  上面程式碼的確達到需求，但有沒有更簡潔的寫法呢?在...</div></div></div></a><a class="pagination-related" href="/2025/01/19/Python-geitem-%E3%80%81-setitem-Magic-Method/" title="Python __geitem__、 __setitem__ Magic Method"><img class="cover" src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/MQ68T61TJP7ZWGBENS27X17RV0.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-19</div><div class="info-item-2">Python __geitem__、 __setitem__ Magic Method</div></div><div class="info-2"><div class="info-item-1">Python Magic Method __geitem__、 __setitem__ Magic Method__getitem__定義： getitem 是一個 Python 魔法方法（或稱為特殊方法），用於實現對象的索引訪問。當你使用索引（例如 obj[index]）訪問對象的元素時，Python 會自動調用 getitem 方法。 用途： 它允許你自定義對象的索引操作行為。你可以控制如何從對象中檢索數據。 1234567891011class MyList:    def __init__(self, data):        self.data = data    def __getitem__(self, index):        return self.data[index]# 使用my_list = MyList([1, 2, 3])print(my_list[1])  # 輸出：2   __setitem__定義： setitem 是另一個 Python 魔法方法，用於設置對象中某個索引位置的值。當你使用索引（例如 obj[index] &#x3D; va...</div></div></div></a><a class="pagination-related" href="/2025/01/19/Web-API%E8%A8%AD%E8%A8%88-API%E5%8F%AF%E8%A6%8B%E6%80%A7%E9%A1%9E%E5%9E%8B/" title="Web API設計 - API可見性類型"><img class="cover" src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/MQ68T61TJP7ZWGBENS27X17RV0.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-19</div><div class="info-item-2">Web API設計 - API可見性類型</div></div><div class="info-2"><div class="info-item-1">API 可見性的類型四種API可見性類型  ##解決方案內部API (Solution-Internal API) 解決方案內部API是用於應用程式內部的元件之間的通信，僅限於應用程式內部使用，不對外開放。  用途：將應用程式依邏輯分解成元件，這些元件暴露API來進行內部通信。 特點： 僅限於內部系統使用，通常由單一專案或產品負責開發、營運和維護。 主要用於服務內部元件的協同工作。    例子：  後端服務間的API：例如，處理用戶資料的服務與支付服務之間的API。 內部數據庫管理API：例如，內部API負責處理數據存取和管理。   夥伴API (Partner API)夥伴API是供特定合作夥伴使用的API，通常會有某些存取限制，且需要合作夥伴進行認證。  用途：用於兩個或多個組織之間進行系統集成和數據共享。 特點： 主要用於與合作夥伴或外部系統的集成。 需要身份驗證和授權來確保安全。 通常用於跨企業或跨部門的協作。    例子：  支付API：例如，支付平台提供的API給商家用於支付處理。 第三方物流API：例如，電子商務平台與物流公司之間的API集成。   公開API (P...</div></div></div></a><a class="pagination-related" href="/2025/01/19/Web-API%E8%A8%AD%E8%A8%88-%E8%A8%AD%E8%A8%88%E8%88%87%E6%8C%91%E6%88%B0/" title="Web API設計 - 設計與挑戰"><img class="cover" src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/MQ68T61TJP7ZWGBENS27X17RV0.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-19</div><div class="info-item-2">Web API設計 - 設計與挑戰</div></div><div class="info-2"><div class="info-item-1">API 設計全名 Application Programming Interface  透過了解需求的優先級，設計者可以在這些選項之間找到平衡。 1. 通用 API vs 特定 API所有客戶端是否應該使用同一個通用 API，還是為不同需求提供特定的 API？  通用 API 優勢： 高重用性，減少重複開發。 易於維護，統一版本管理。   劣勢： 可能過於複雜，導致學習曲線陡峭。 難以滿足特定需求，客戶端需進行額外的資料處理。 設計過於通用時，API定義模糊不清。   例子：GraphQL 允許客戶端自行定義所需的資料結構。   特定 API 優勢： 精準滿足需求，減少客戶端資料處理負擔。 更易於理解，適合特定場景。   劣勢： 重複開發，增加維護成本。 客戶端需求變更時，需頻繁修改 API。   例子：REST API 中 /users/{id} 提供特定使用者的資訊，而 /users 提供所有使用者的資訊。     2. 細 vs 粗的EndPoint(端點)與操作範圍如何在API的功能廣度與深度之間取得平衡?  細粒度端點 優勢： 更靈活，可精確執行操作。 客戶端只需請求所...</div></div></div></a><a class="pagination-related" href="/2025/01/19/Python-Anti-pattern/" title="Python Anti-pattern"><img class="cover" src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/MQ68T61TJP7ZWGBENS27X17RV0.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-19</div><div class="info-item-2">Python Anti-pattern</div></div><div class="info-2"><div class="info-item-1">Anti-pattern指在軟體開發中，看似合理的解決方案，但實際上會導致更多問題且難以維護的設計，從設計中可以看到這些常見特性 :  難以維護  難以閱讀  難以擴展  性能問題  漏洞  副作用多  短期開發速成，長期有害(技術債)   Anti-pattern反設計可以指任何的設計而非只有code的設計，例如:資料庫Schema設計，系統設計等等。本篇是針對code的設計去探討  常見的Anti-pattern God Object（上帝物件）描述：一個物件負責過多的功能，導致高度耦合，缺乏單一責任性。問題：難以測試和維護，修改一個功能可能壞多個功能。 Spaghetti Code（意大利麵條代碼）描述：結構混亂，通常是因為過度使用全局變量或缺乏清晰的模塊劃分。問題：難以理解和修改，任何變動都可能導致不可預見的錯誤。 Cargo Cult Programming描述：盲目地模仿設計模式或是方法，而不理解其內在的原理和適用範圍。問題：通常會在錯誤的上下文中使用，導致不合適的解決方案。 假設開發者看到某個項目中使用了多重繼承，便在自己的代碼中也使用這種模式，儘管實際上不需要。 ...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/CQ6DT61DJP7CWGBANS27X17RV0.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Jed Hung</div><div class="author-info-description">邁向雲原生&架構師之路</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">27</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">21</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">18</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/JED-4a6g0109"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">放我的學習筆記</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#macOS-%E9%80%8F%E9%81%8E-langchain-%E5%9C%A8-local-%E4%BD%BF%E7%94%A8llama-%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.</span> <span class="toc-text">macOS 透過 langchain 在 local 使用llama 模型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#step1-%E4%B8%8B%E8%BC%89%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.1.</span> <span class="toc-text">step1. 下載模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#step2-%E5%AE%89%E8%A3%9DMetal-GPU-MacOS-conda%E7%89%88%E6%9C%AC%E7%89%88%E6%9C%AC"><span class="toc-number">1.2.</span> <span class="toc-text">step2 安裝Metal GPU MacOS conda版本版本</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%9Dxcode"><span class="toc-number">1.2.1.</span> <span class="toc-text">安裝xcode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%9Dconda"><span class="toc-number">1.2.2.</span> <span class="toc-text">安裝conda</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BB%BA%E7%BD%AEconda%E7%92%B0%E5%A2%83"><span class="toc-number">1.2.3.</span> <span class="toc-text">建置conda環境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BB%BA%E7%AB%8B%E5%B0%88%E6%A1%88"><span class="toc-number">1.2.4.</span> <span class="toc-text">建立專案</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/02/10/Hash-%E5%93%88%E5%B8%8C%E3%80%81%E9%9B%9C%E6%B9%8A/" title="Hash(哈希、雜湊)"><img src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/xa6tpsoqTQDyslzqHusztEOiZ4YAYB05.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hash(哈希、雜湊)"/></a><div class="content"><a class="title" href="/2025/02/10/Hash-%E5%93%88%E5%B8%8C%E3%80%81%E9%9B%9C%E6%B9%8A/" title="Hash(哈希、雜湊)">Hash(哈希、雜湊)</a><time datetime="2025-02-10T09:02:48.461Z" title="Created 2025-02-10 17:02:48">2025-02-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/02/06/%E5%A0%86%E7%96%8A-Stack/" title="堆疊(Stack)"><img src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/AJlUGQxMphTRULj2G0LhWfNHjeZgQUuO.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="堆疊(Stack)"/></a><div class="content"><a class="title" href="/2025/02/06/%E5%A0%86%E7%96%8A-Stack/" title="堆疊(Stack)">堆疊(Stack)</a><time datetime="2025-02-06T13:50:02.159Z" title="Created 2025-02-06 21:50:02">2025-02-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/02/06/%E4%BD%87%E5%88%97-Queue/" title="佇列(Queue)"><img src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/AJlUGQxMphTRULj2G0LhWfNHjeZgQUuO.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="佇列(Queue)"/></a><div class="content"><a class="title" href="/2025/02/06/%E4%BD%87%E5%88%97-Queue/" title="佇列(Queue)">佇列(Queue)</a><time datetime="2025-02-06T08:44:39.592Z" title="Created 2025-02-06 16:44:39">2025-02-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/02/05/%E9%8F%88%E7%B5%90%E4%B8%B2%E5%88%97-Linked-List/" title="鏈結串列(Linked List)"><img src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/u1DqPVdoQex63jMr0edeKqLVXf6JaPVN.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="鏈結串列(Linked List)"/></a><div class="content"><a class="title" href="/2025/02/05/%E9%8F%88%E7%B5%90%E4%B8%B2%E5%88%97-Linked-List/" title="鏈結串列(Linked List)">鏈結串列(Linked List)</a><time datetime="2025-02-05T14:31:49.548Z" title="Created 2025-02-05 22:31:49">2025-02-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/02/04/%E9%99%A3%E5%88%97-Array-%E6%A6%82%E5%BF%B5%E8%88%87%E4%BB%8B%E7%B4%B9/" title="陣列(Array)概念與介紹"><img src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/HR21KzZAddWqXVimHGkaCdAKIOYUIfb1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="陣列(Array)概念與介紹"/></a><div class="content"><a class="title" href="/2025/02/04/%E9%99%A3%E5%88%97-Array-%E6%A6%82%E5%BF%B5%E8%88%87%E4%BB%8B%E7%B4%B9/" title="陣列(Array)概念與介紹">陣列(Array)概念與介紹</a><time datetime="2025-02-04T09:37:45.398Z" title="Created 2025-02-04 17:37:45">2025-02-04</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By Jed Hung</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.3</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.3"></script><script src="/js/main.js?v=5.5.3"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const config = mermaidSrc.dataset.config ? JSON.parse(mermaidSrc.dataset.config) : {}
      if (!config.theme) {
        config.theme = theme
      }
      const mermaidThemeConfig = `%%{init: ${JSON.stringify(config)}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid@11.12.2/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>