<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>API防禦性程式設計 | Jed學習筆記</title><meta name="author" content="Jed Hung"><meta name="copyright" content="Jed Hung"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="防禦性設計專注於程式上的保護，本文將探討Value substitition 以及expcetion處理部分">
<meta property="og:type" content="article">
<meta property="og:title" content="API防禦性程式設計">
<meta property="og:url" content="https://jed-4a6g0109.github.io/Software-Jed/2025/01/19/API%E9%98%B2%E7%A6%A6%E6%80%A7%E7%A8%8B%E5%BC%8F%E8%A8%AD%E8%A8%88/index.html">
<meta property="og:site_name" content="Jed學習筆記">
<meta property="og:description" content="防禦性設計專注於程式上的保護，本文將探討Value substitition 以及expcetion處理部分">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/MQ68T61TJP7ZWGBENS27X17RV0.jpeg">
<meta property="article:published_time" content="2025-01-19T13:11:46.377Z">
<meta property="article:modified_time" content="2025-12-14T13:00:32.265Z">
<meta property="article:author" content="Jed Hung">
<meta property="article:tag" content="API">
<meta property="article:tag" content="Python">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/MQ68T61TJP7ZWGBENS27X17RV0.jpeg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "API防禦性程式設計",
  "url": "https://jed-4a6g0109.github.io/Software-Jed/2025/01/19/API%E9%98%B2%E7%A6%A6%E6%80%A7%E7%A8%8B%E5%BC%8F%E8%A8%AD%E8%A8%88/",
  "image": "https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/MQ68T61TJP7ZWGBENS27X17RV0.jpeg",
  "datePublished": "2025-01-19T13:11:46.377Z",
  "dateModified": "2025-12-14T13:00:32.265Z",
  "author": [
    {
      "@type": "Person",
      "name": "Jed Hung",
      "url": "https://jed-4a6g0109.github.io/Software-Jed"
    }
  ]
}</script><link rel="shortcut icon" href="/Software-Jed/img/favicon.png"><link rel="canonical" href="https://jed-4a6g0109.github.io/Software-Jed/2025/01/19/API%E9%98%B2%E7%A6%A6%E6%80%A7%E7%A8%8B%E5%BC%8F%E8%A8%AD%E8%A8%88/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/Software-Jed/css/index.css?v=5.5.3"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/Software-Jed/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'API防禦性程式設計',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.1.1"></head><body><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/MQ68T61TJP7ZWGBENS27X17RV0.jpeg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/Software-Jed/"><span class="site-name">Jed學習筆記</span></a><a class="nav-page-title" href="/Software-Jed/"><span class="site-name">API防禦性程式設計</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"></div></nav><div id="post-info"><h1 class="post-title">API防禦性程式設計</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-01-19T13:11:46.377Z" title="Created 2025-01-19 21:11:46">2025-01-19</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-12-14T13:00:32.265Z" title="Updated 2025-12-14 21:00:32">2025-12-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/Software-Jed/categories/API/">API</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/Software-Jed/categories/API/Python/">Python</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="防禦性程式設計"><a href="#防禦性程式設計" class="headerlink" title="防禦性程式設計"></a>防禦性程式設計</h1><hr>
<h2 id="防禦性程式"><a href="#防禦性程式" class="headerlink" title="防禦性程式"></a>防禦性程式</h2><p>防禦性設計與<a target="_blank" rel="noopener" href="https://hackmd.io/LCnn8R9GQxGQgKN2sAtocg#Design-by-Contract-DbC">DbC合約設計</a>有些不同，防禦性設計專注於程式上的保護，但這兩項設計並沒有相斥，是可以互補的</p>
<h3 id="Value-substitution-值的替換"><a href="#Value-substitution-值的替換" class="headerlink" title="Value substitution (值的替換)"></a>Value substitution (值的替換)</h3><p>當輸入非預期值必須要處理的情境<br>例子:  api interface定義article_id要傳遞的是int，但client卻輸入str，像這種情況就需要處理，即使<code>DbC</code>合約上沒講也應該要防呆</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/api/v1/articles/<span class="punctuation">&#123;</span>article_id<span class="punctuation">&#125;</span>/comments</span><br></pre></td></tr></table></figure>

<p>遇到這種情境通常會使用<code>Value substitution</code>來解決，直接舉例API常見的情況，當<code>client</code>傳遞參數到後端時，需要做非預期值的處理，將錯誤轉成HTTP Code 告知 client為錯誤格式請求，避免讓程式直接<code>error</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI, HTTPException</span><br><span class="line"><span class="keyword">import</span> uvicorn</span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line">db = &#123;<span class="number">1</span>: &#123;<span class="string">&quot;article_id&quot;</span>: <span class="number">1</span>, <span class="string">&quot;comments&quot;</span>: [<span class="string">&quot;Great post!&quot;</span>, <span class="string">&quot;Very informative.&quot;</span>]&#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/api/v1/articles/&#123;article_id&#125;/comments&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_comments</span>(<span class="params">article_id: <span class="built_in">int</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(article_id, <span class="built_in">int</span>):</span><br><span class="line">        <span class="keyword">raise</span> HTTPException(status_code=<span class="number">400</span>, detail=<span class="string">&quot;Invalid article_id. It must be a positive integer.&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> db[article_id]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    uvicorn.run(app, host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">8000</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>如果沒有做<code>Value substitution</code>來解決會直接看到500 error這到還好，千萬不要讓以下情況發生，連Traceback訊息直接噴給client，反而把程式資訊都洩漏出去了，這種情竟你一定有在一些處理不好的網站遇到過</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">File <span class="string">&quot;D:\python_program\pythonProject\Auth\dd.py&quot;</span>, line <span class="number">15</span>, <span class="keyword">in</span> get_comments</span><br><span class="line"><span class="keyword">return</span> db[article_id]</span><br><span class="line">KeyError: <span class="number">12</span></span><br></pre></td></tr></table></figure>

<h3 id="Exception-handling-例外處理"><a href="#Exception-handling-例外處理" class="headerlink" title="Exception handling(例外處理)"></a>Exception handling(例外處理)</h3><p>需要設想可能會發生的錯誤，以及設想不可能發生的處理，當錯誤發生時應回覆當前資訊，而不是忽略或嘗試進到下個程式處理流程</p>
<p>例子1: 在設計get api時，就應該設想拿不到資源的可能性，透過Exception 訊息暴露出去給client，讓client明確知道錯誤與現在狀況，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI, HTTPException</span><br><span class="line"><span class="keyword">import</span> uvicorn</span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line">db = &#123;<span class="number">1</span>: &#123;<span class="string">&quot;article_id&quot;</span>: <span class="number">1</span>, <span class="string">&quot;comments&quot;</span>: [<span class="string">&quot;Great post!&quot;</span>, <span class="string">&quot;Very informative.&quot;</span>]&#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/api/v1/articles/&#123;article_id&#125;/comments&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_comments</span>(<span class="params">article_id: <span class="built_in">int</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(article_id, <span class="built_in">int</span>):</span><br><span class="line">        <span class="keyword">raise</span> HTTPException(status_code=<span class="number">400</span>, detail=<span class="string">&quot;Invalid article_id. It must be a positive integer.&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (query_result := db.get(article_id)):</span><br><span class="line">        <span class="keyword">raise</span> HTTPException(status_code=<span class="number">404</span>, detail=<span class="string">&quot;Resource not found.&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> query_result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    uvicorn.run(app, host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">8000</span>)</span><br></pre></td></tr></table></figure>

<p>例子2 當非預期錯誤發生時，應該要做以下三點處理</p>
<ul>
<li>Value substitution<br>  將錯誤替換成500 Error HTTP Status Code</li>
<li>Exception handling<br>  raise excpetion 告知client目前錯誤情況</li>
<li>Error logging<br>  透過log做非預期錯誤的紀錄</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI, HTTPException</span><br><span class="line"><span class="keyword">import</span> uvicorn</span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line">db = &#123;<span class="number">1</span>: &#123;<span class="string">&quot;article_id&quot;</span>: <span class="number">1</span>, <span class="string">&quot;comments&quot;</span>: [<span class="string">&quot;Great post!&quot;</span>, <span class="string">&quot;Very informative.&quot;</span>]&#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/api/v1/articles/&#123;article_id&#125;/comments&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_comments</span>(<span class="params">article_id: <span class="built_in">int</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(article_id, <span class="built_in">int</span>):</span><br><span class="line">        <span class="keyword">raise</span> HTTPException(status_code=<span class="number">400</span>, detail=<span class="string">&quot;Invalid article_id. It must be a positive integer.&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> (query_result := db.get(article_id)):</span><br><span class="line">            <span class="keyword">raise</span> HTTPException(status_code=<span class="number">404</span>, detail=<span class="string">&quot;Resource not found.&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> query_result</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        logging.info(<span class="string">f&#x27;server error information:<span class="subst">&#123;e&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">raise</span> HTTPException(status_code=<span class="number">500</span>, detail=<span class="string">&quot;An unexpected error occurred. Please try again. If the issue persists, please contact customer support.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    uvicorn.run(app, host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">8000</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Exception 可以做到防禦程式設計但也請不要濫用</p>
<blockquote>
<p>💡切記try catch 請慎重處理錯誤，須明確讓人知道錯誤，如果不是特殊情境也不要隱蓋錯誤，或者可透過logging進行紀錄</p>
</blockquote>
<h3 id="請不要使用Exception來處理業務邏輯中的常規條件"><a href="#請不要使用Exception來處理業務邏輯中的常規條件" class="headerlink" title="請不要使用Exception來處理業務邏輯中的常規條件"></a>請不要使用Exception來處理業務邏輯中的常規條件</h3><p><code>Exception</code>處理正常的業務邏輯流程混再一起</p>
<p>例子: 使用 ValueError 來處理年齡驗證是一種不良做法，因為年齡驗證是業務邏輯的一部分，而不是異常狀況。應該使用條件語句來進行這種驗證。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, age</span>):</span><br><span class="line">        <span class="variable language_">self</span>.name = name</span><br><span class="line">        <span class="variable language_">self</span>.age = age</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register_user</span>(<span class="params">user</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> user.age &lt; <span class="number">18</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;User must be at least 18 years old&quot;</span>)</span><br><span class="line">        <span class="comment"># 正常處理註冊邏輯</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;User <span class="subst">&#123;user.name&#125;</span> registered successfully&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Registration error: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用例外來控制流程</span></span><br><span class="line">user1 = User(<span class="string">&quot;Alice&quot;</span>, <span class="number">16</span>)</span><br><span class="line">register_user(user1)  <span class="comment"># 這裡會引發例外，但這應該是業務邏輯的正常判斷</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>業務邏輯要與實際程式邏輯區隔開來，不要混再一起增加邏輯複雜度與維護困難</p>
<p>你應該這麼做: 使用 if 條件語句來驗證年齡，並返回布林值表示註冊是否成功。在處理失敗情況時，可以根據需要執行額外的操作，例如聯繫客服。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, age</span>):</span><br><span class="line">        <span class="variable language_">self</span>.name = name</span><br><span class="line">        <span class="variable language_">self</span>.age = age</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register_user</span>(<span class="params">user</span>):</span><br><span class="line">    <span class="keyword">if</span> user.age &lt; <span class="number">18</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Registration failed: User must be at least 18 years old&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="comment"># 正常處理註冊邏輯</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;User <span class="subst">&#123;user.name&#125;</span> registered successfully&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用條件語句進行年齡驗證</span></span><br><span class="line">user1 = User(<span class="string">&quot;Alice&quot;</span>, <span class="number">16</span>)</span><br><span class="line">success = register_user(user1)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> success:</span><br><span class="line">    <span class="comment"># 處理註冊失敗的情況與處理業務邏輯部分</span></span><br><span class="line">    <span class="keyword">raise</span> ValueError(<span class="string">&quot;Please contact support for further assistance.&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="請不要在function中使用Exception來處理所有條件"><a href="#請不要在function中使用Exception來處理所有條件" class="headerlink" title="請不要在function中使用Exception來處理所有條件"></a>請不要在function中使用Exception來處理所有條件</h3><p>過度依賴<code>Exception</code>處理以及暴露呼叫者不需關注的訊息</p>
<p>例子: 所有的條件檢查都使用了<code>Exception</code>。應該使用條件語句來驗證輸入的合法性，並在需要時返回錯誤狀態，而不是引發<code>Exception</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">calculate_discount</span>(<span class="params">price, discount</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> price &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;Price cannot be negative&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> discount &lt; <span class="number">0</span> <span class="keyword">or</span> discount &gt; <span class="number">100</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;Discount must be between 0 and 100&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> price * (<span class="number">1</span> - discount / <span class="number">100</span>)</span><br><span class="line">    <span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Error calculating discount: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用例外來處理所有條件</span></span><br><span class="line">discounted_price = calculate_discount(-<span class="number">100</span>, <span class="number">20</span>)  <span class="comment"># 這裡會引發例外，應該使用條件語句處理這些檢查</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>你應該這麼做: 外部代碼根據返回的錯誤信息來處理錯誤情況，而不是依賴例外，以及<code>raise</code> 呼叫者所關注的<code>Exception</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">calculate_discount</span>(<span class="params">price, discount</span>):</span><br><span class="line">    <span class="keyword">if</span> price &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span>, <span class="string">&quot;Price cannot be negative&quot;</span></span><br><span class="line">    <span class="keyword">if</span> discount &lt; <span class="number">0</span> <span class="keyword">or</span> discount &gt; <span class="number">100</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span>, <span class="string">&quot;Discount must be between 0 and 100&quot;</span></span><br><span class="line">    <span class="keyword">return</span> price * (<span class="number">1</span> - discount / <span class="number">100</span>), <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用條件語句處理所有條件</span></span><br><span class="line">discounted_price, error = calculate_discount(-<span class="number">100</span>, <span class="number">20</span>)</span><br><span class="line"><span class="keyword">if</span> error:</span><br><span class="line">    <span class="keyword">raise</span> ValueError(<span class="string">f&quot;Error calculating discount: <span class="subst">&#123;error&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Discounted price: <span class="subst">&#123;discounted_price&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>💡過多的Exception會弱化封裝，因為一直暴露內部訊息，如果遇到過多Exception請將分解多個function或內聚Exception職責，如DB只會有DB相關Exception，業務邏輯function只會有業務邏輯Exception，驗證function只會有專注驗證的Exception</p>
</blockquote>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://jed-4a6g0109.github.io/Software-Jed">Jed Hung</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://jed-4a6g0109.github.io/Software-Jed/2025/01/19/API%E9%98%B2%E7%A6%A6%E6%80%A7%E7%A8%8B%E5%BC%8F%E8%A8%AD%E8%A8%88/">https://jed-4a6g0109.github.io/Software-Jed/2025/01/19/API%E9%98%B2%E7%A6%A6%E6%80%A7%E7%A8%8B%E5%BC%8F%E8%A8%AD%E8%A8%88/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/Software-Jed/tags/API/">API</a><a class="post-meta__tags" href="/Software-Jed/tags/Python/">Python</a></div><div class="post-share"><div class="social-share" data-image="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/MQ68T61TJP7ZWGBENS27X17RV0.jpeg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/Software-Jed/2025/01/19/Design-by-Contract-DbC/" title="Design by Contract (DbC)"><img class="cover" src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/MQ68T61TJP7ZWGBENS27X17RV0.jpeg" onerror="onerror=null;src='/Software-Jed/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">Design by Contract (DbC)</div></div><div class="info-2"><div class="info-item-1">Design by Contract (DbC)依合約設計（Design by Contract, DbC）是一種設計方法，預期輸入、輸出和副作用皆備有文件記錄下來。合約描述期望程式碼的運作方式以及呼叫者期望得到的回應，這就是合約設計。  開發與合約細節DbC 通常由雙方協議與開發，若合約被違反，則會拋出異常處理來說明無法運行的原因。 設計者要經常問：  它期望的是什麼？ 它要保證的是什麼？ 它要保持的是什麼？  以下均為合約的一部分:  可接受和不可接受的值或類型，以及它們的含義  返回的值或類型，以及它們的含義  可能出現的錯誤以及異常情況的值和類型，以及它們的含義  前置條件：呼叫函數前必須完成的條件  例如：使用日幣與台幣匯率轉換函式前，貨幣需要是整數，且輸入的貨幣不能為負數（對呼叫者施加限制） 前置條件若未滿足，則程式不應執行     後置條件：呼叫者呼叫函數所期望的結果，並進行驗證  例如：日幣轉換成台幣時，函式會做匯率轉換，並驗證台幣幣值是否大於日幣（事後驗證）。驗證通過後回傳匯率結果   不變量：程式執行多少次都不會變動的事物  例如：換匯手續費永遠不變，就是 0...</div></div></div></a><a class="pagination-related" href="/Software-Jed/2025/01/19/%E7%B0%A1%E5%96%AE%E5%B7%A5%E5%BB%A0%E6%A8%A1%E5%BC%8F%E8%A8%AD%E8%A8%88-%E5%89%B5%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/" title="簡單工廠模式設計(創建型模式)"><img class="cover" src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/MQ68T61TJP7ZWGBENS27X17RV0.jpeg" onerror="onerror=null;src='/Software-Jed/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">簡單工廠模式設計(創建型模式)</div></div><div class="info-2"><div class="info-item-1">工廠模式設計(創建型模式) 簡單工廠 工廠方法 抽象工廠  簡單工廠(靜態工廠)在可提取共通邏輯進行抽象，並封裝且隱藏實作細節，常運用在初期系統開發以及產品數量較少且變化不頻繁的場景  工廠類提供靜態方法來選擇要建立的實例 根據參數透過工廠來建立實例 有些書歸類為是程式上的風格不一定歸納為設計  今天啊浩去三媽臭臭鍋吃飯，然後看到了三媽的飲料機，而飲料機比喻為工廠，提供了可樂，雪碧，檸檬紅茶，三種飲料，基底都是水，外部透過參數選擇要建立的飲料，並流出來 水為抽象類(基類)  可樂 雪碧 檸檬紅茶  飲料則定了三個class，各自實作飲料，雖然現實中飲料機是直接現成飲料倒進去XD，我們想像飲料機有了水只要加上飲料的原料就能生產飲料出來  💡無需傳遞實例變量、無需實例，簡單工程又稱靜態工廠  UML 類圖 特性 無需關注與理解工廠內部實作，只需傳遞參數建立實例 建立職責區分開 在業務需求不變下只需繼承base class就能快速創建新需求  場景123456789101112131415161718192021222324252627282930313233343536373839...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/Software-Jed/2025/01/19/Web-API%E8%A8%AD%E8%A8%88-API%E5%8F%AF%E8%A6%8B%E6%80%A7%E9%A1%9E%E5%9E%8B/" title="Web API設計 - API可見性類型"><img class="cover" src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/MQ68T61TJP7ZWGBENS27X17RV0.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-19</div><div class="info-item-2">Web API設計 - API可見性類型</div></div><div class="info-2"><div class="info-item-1">API 可見性的類型四種API可見性類型  ##解決方案內部API (Solution-Internal API) 解決方案內部API是用於應用程式內部的元件之間的通信，僅限於應用程式內部使用，不對外開放。  用途：將應用程式依邏輯分解成元件，這些元件暴露API來進行內部通信。 特點： 僅限於內部系統使用，通常由單一專案或產品負責開發、營運和維護。 主要用於服務內部元件的協同工作。    例子：  後端服務間的API：例如，處理用戶資料的服務與支付服務之間的API。 內部數據庫管理API：例如，內部API負責處理數據存取和管理。   夥伴API (Partner API)夥伴API是供特定合作夥伴使用的API，通常會有某些存取限制，且需要合作夥伴進行認證。  用途：用於兩個或多個組織之間進行系統集成和數據共享。 特點： 主要用於與合作夥伴或外部系統的集成。 需要身份驗證和授權來確保安全。 通常用於跨企業或跨部門的協作。    例子：  支付API：例如，支付平台提供的API給商家用於支付處理。 第三方物流API：例如，電子商務平台與物流公司之間的API集成。   公開API (P...</div></div></div></a><a class="pagination-related" href="/Software-Jed/2025/01/19/Web-API%E8%A8%AD%E8%A8%88-%E8%A8%AD%E8%A8%88%E8%88%87%E6%8C%91%E6%88%B0/" title="Web API設計 - 設計與挑戰"><img class="cover" src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/MQ68T61TJP7ZWGBENS27X17RV0.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-19</div><div class="info-item-2">Web API設計 - 設計與挑戰</div></div><div class="info-2"><div class="info-item-1">API 設計全名 Application Programming Interface  透過了解需求的優先級，設計者可以在這些選項之間找到平衡。 1. 通用 API vs 特定 API所有客戶端是否應該使用同一個通用 API，還是為不同需求提供特定的 API？  通用 API 優勢： 高重用性，減少重複開發。 易於維護，統一版本管理。   劣勢： 可能過於複雜，導致學習曲線陡峭。 難以滿足特定需求，客戶端需進行額外的資料處理。 設計過於通用時，API定義模糊不清。   例子：GraphQL 允許客戶端自行定義所需的資料結構。   特定 API 優勢： 精準滿足需求，減少客戶端資料處理負擔。 更易於理解，適合特定場景。   劣勢： 重複開發，增加維護成本。 客戶端需求變更時，需頻繁修改 API。   例子：REST API 中 /users/{id} 提供特定使用者的資訊，而 /users 提供所有使用者的資訊。     2. 細 vs 粗的EndPoint(端點)與操作範圍如何在API的功能廣度與深度之間取得平衡?  細粒度端點 優勢： 更靈活，可精確執行操作。 客戶端只需請求所...</div></div></div></a><a class="pagination-related" href="/Software-Jed/2025/01/19/Python-Clean-Code-%E6%A6%82%E5%BF%B5%E4%BB%A5%E5%8F%8A%E6%B7%BA%E8%AB%87/" title="Python Clean Code"><img class="cover" src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/XWU53IIYXCG7KEQ4F4591FESDS5YH0LC.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-19</div><div class="info-item-2">Python Clean Code</div></div><div class="info-2"><div class="info-item-1">Python Clean Code 概念以及淺談(1)此文章主要講述  何謂 Clean Code? Python 結構化、格式化、統一程式碼與該如何落實Code style規範與工具  何謂Clean Code?何謂Clean Code? 其實沒有一定的答案也沒有絕對，但Clean Code不限語言有這幾種常見特性  簡潔明瞭：程式碼應該易於理解，避免不必要的複雜性。 可讀性：良好的命名、適當的註解和結構化的代碼有助於其他開發者快速理解程式碼的功能。 可維護性：程式碼應該易於修改和擴展，能夠適應未來的需求變更。 一致性：遵循一致的編碼風格和規範，保持程式碼的一致性。  專業的軟體工程師寫程式不是寫給機器的，目的除了給機器跑能動以外還要人能看的懂才是好Code  Clean Code重要性可維護性和可閱讀性直接影響開發速度和專案的可行性。如果收到需求後需要花時間進行重構，並且每次收到新需求時都要重構，不僅會浪費時間，還可能導致重構的成本超過重新設計的成本。更糟的是，如果在重構過程中引發了錯誤，可能會導致服務中斷或產品無法使用。這些情況是軟體工程師最不希望遇到的。這樣的情況充分說明...</div></div></div></a><a class="pagination-related" href="/Software-Jed/2025/01/19/Python-contains-Magic-Method/" title="Python__contains__ Magic Method"><img class="cover" src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/MQ68T61TJP7ZWGBENS27X17RV0.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-19</div><div class="info-item-2">Python__contains__ Magic Method</div></div><div class="info-2"><div class="info-item-1">Python container object container object由__contains__方法實作，在使用 in 時被呼叫 1234i in container# 實際操作container.__contains__(i)  透過in強化程式可讀性另外在判斷條件情境下使用__container__會幫助可讀性以及class的內聚，來舉個例子，假設有個相撲遊戲，舞台為10 * 10正方形範圍，需要判斷玩家是否在舞台內以及出界 使用function實作使用function雖然能理解但不值觀，需要透過function的明確命名，以及function內處理if邏輯很難看懂x與y意圖，在閱讀上需要整段code看完才能理解 1234567891011121314151617def is_position_within_stage(position, stage_size):    x, y = position    return 0 &lt;= x &lt;= stage_size and 0 &lt;= y &lt;= stage_size# 創建舞台邊長stage_si...</div></div></div></a><a class="pagination-related" href="/Software-Jed/2025/01/19/%E5%B7%A5%E5%BB%A0%E6%A8%A1%E5%BC%8F%E8%A8%AD%E8%A8%88-%E5%89%B5%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/" title="工廠模式設計(創建型模式)"><img class="cover" src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/MQ68T61TJP7ZWGBENS27X17RV0.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-19</div><div class="info-item-2">工廠模式設計(創建型模式)</div></div><div class="info-2"><div class="info-item-1">工廠模式設計(創建型模式) 工廠方法與簡單工廠差異在於  工廠類不負責創建，而是交由子類來決定實例  遵循開閉原則：   可以透過引進新的具體工廠類來擴展產品的種類，而不需要修改現有代碼。  遵循單一職責原則：   每個具體工廠類別只負責創造一種特定產品，職責單一，程式碼更清晰。  增強程式碼的靈活性：   子類別可以覆寫工廠方法來改變創建產品的方式，增強了程式碼的靈活性和可擴展性。   在可提取共通邏輯進行抽象，並封裝且隱藏實作細節，能夠隨著需求快速創建物件的場景     來時做一個案例，今天收到需求是串接第三方服務來登入，有X、Meta、Google，在第三方服務需實作登入以及確認服務狀態，所以提取出共通行為進行抽象基類 123456789101112from abc import ABC, abstractmethodclass ThirdPartyServices(ABC):    @abstractmethod    def login(self):        pass    @abstractmethod    def get_health_status(self...</div></div></div></a><a class="pagination-related" href="/Software-Jed/2025/01/19/Python-Context-manager/" title="Python Context manager"><img class="cover" src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/MQ68T61TJP7ZWGBENS27X17RV0.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-19</div><div class="info-item-2">Python Context manager</div></div><div class="info-2"><div class="info-item-1">Python Context manager上下文管理器（Context Manager）在 Python 中，上下文管理器是一種自動管理資源的工具，能幫助我們確保在使用完資源後進行適當的清理。中文有一句成語叫「前因後果」，我們可以用這個成語來形象地解釋上下文管理器的作用。 例子 假設今天老闆要求你用財務上半季的營收 Excel 檔案視覺化為長條圖。要完成這個任務，我們首先需要讀取 Excel 檔案。這裡，我們可以使用上下文管理器來處理檔案的打開和關閉。  前因：因為需要處理某個資源（如打開文件），所以我們寫了一段代碼來操作這個資源。 後果：當代碼執行完畢後，需要進行一些清理工作（如關閉文件），這樣可以確保資源被正確地釋放。  例子1 1234567# 上下文管理器示例excel_file = open(&#x27;202401.csv&#x27;)  # 上文 (前因)try:    excel_to_bar_chart(excel_file)finally:    excel_file.close()  # 下文 (後果)  上面程式碼的確達到需求，但有沒有更簡潔的寫法呢?在...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/CQ6DT61DJP7CWGBANS27X17RV0.png" onerror="this.onerror=null;this.src='/Software-Jed/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Jed Hung</div><div class="author-info-description">邁向雲原生&架構師之路</div><div class="site-data"><a href="/Software-Jed/archives/"><div class="headline">Articles</div><div class="length-num">27</div></a><a href="/Software-Jed/tags/"><div class="headline">Tags</div><div class="length-num">21</div></a><a href="/Software-Jed/categories/"><div class="headline">Categories</div><div class="length-num">18</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/JED-4a6g0109"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">放我的學習筆記</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%98%B2%E7%A6%A6%E6%80%A7%E7%A8%8B%E5%BC%8F%E8%A8%AD%E8%A8%88"><span class="toc-number">1.</span> <span class="toc-text">防禦性程式設計</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%98%B2%E7%A6%A6%E6%80%A7%E7%A8%8B%E5%BC%8F"><span class="toc-number">1.1.</span> <span class="toc-text">防禦性程式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Value-substitution-%E5%80%BC%E7%9A%84%E6%9B%BF%E6%8F%9B"><span class="toc-number">1.1.1.</span> <span class="toc-text">Value substitution (值的替換)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Exception-handling-%E4%BE%8B%E5%A4%96%E8%99%95%E7%90%86"><span class="toc-number">1.1.2.</span> <span class="toc-text">Exception handling(例外處理)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AB%8B%E4%B8%8D%E8%A6%81%E4%BD%BF%E7%94%A8Exception%E4%BE%86%E8%99%95%E7%90%86%E6%A5%AD%E5%8B%99%E9%82%8F%E8%BC%AF%E4%B8%AD%E7%9A%84%E5%B8%B8%E8%A6%8F%E6%A2%9D%E4%BB%B6"><span class="toc-number">1.1.3.</span> <span class="toc-text">請不要使用Exception來處理業務邏輯中的常規條件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AB%8B%E4%B8%8D%E8%A6%81%E5%9C%A8function%E4%B8%AD%E4%BD%BF%E7%94%A8Exception%E4%BE%86%E8%99%95%E7%90%86%E6%89%80%E6%9C%89%E6%A2%9D%E4%BB%B6"><span class="toc-number">1.1.4.</span> <span class="toc-text">請不要在function中使用Exception來處理所有條件</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/Software-Jed/2025/02/10/Hash-%E5%93%88%E5%B8%8C%E3%80%81%E9%9B%9C%E6%B9%8A/" title="Hash(哈希、雜湊)"><img src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/xa6tpsoqTQDyslzqHusztEOiZ4YAYB05.png" onerror="this.onerror=null;this.src='/Software-Jed/img/404.jpg'" alt="Hash(哈希、雜湊)"/></a><div class="content"><a class="title" href="/Software-Jed/2025/02/10/Hash-%E5%93%88%E5%B8%8C%E3%80%81%E9%9B%9C%E6%B9%8A/" title="Hash(哈希、雜湊)">Hash(哈希、雜湊)</a><time datetime="2025-02-10T09:02:48.461Z" title="Created 2025-02-10 17:02:48">2025-02-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Software-Jed/2025/02/06/%E5%A0%86%E7%96%8A-Stack/" title="堆疊(Stack)"><img src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/AJlUGQxMphTRULj2G0LhWfNHjeZgQUuO.png" onerror="this.onerror=null;this.src='/Software-Jed/img/404.jpg'" alt="堆疊(Stack)"/></a><div class="content"><a class="title" href="/Software-Jed/2025/02/06/%E5%A0%86%E7%96%8A-Stack/" title="堆疊(Stack)">堆疊(Stack)</a><time datetime="2025-02-06T13:50:02.159Z" title="Created 2025-02-06 21:50:02">2025-02-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Software-Jed/2025/02/06/%E4%BD%87%E5%88%97-Queue/" title="佇列(Queue)"><img src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/AJlUGQxMphTRULj2G0LhWfNHjeZgQUuO.png" onerror="this.onerror=null;this.src='/Software-Jed/img/404.jpg'" alt="佇列(Queue)"/></a><div class="content"><a class="title" href="/Software-Jed/2025/02/06/%E4%BD%87%E5%88%97-Queue/" title="佇列(Queue)">佇列(Queue)</a><time datetime="2025-02-06T08:44:39.592Z" title="Created 2025-02-06 16:44:39">2025-02-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Software-Jed/2025/02/05/%E9%8F%88%E7%B5%90%E4%B8%B2%E5%88%97-Linked-List/" title="鏈結串列(Linked List)"><img src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/u1DqPVdoQex63jMr0edeKqLVXf6JaPVN.png" onerror="this.onerror=null;this.src='/Software-Jed/img/404.jpg'" alt="鏈結串列(Linked List)"/></a><div class="content"><a class="title" href="/Software-Jed/2025/02/05/%E9%8F%88%E7%B5%90%E4%B8%B2%E5%88%97-Linked-List/" title="鏈結串列(Linked List)">鏈結串列(Linked List)</a><time datetime="2025-02-05T14:31:49.548Z" title="Created 2025-02-05 22:31:49">2025-02-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Software-Jed/2025/02/04/%E9%99%A3%E5%88%97-Array-%E6%A6%82%E5%BF%B5%E8%88%87%E4%BB%8B%E7%B4%B9/" title="陣列(Array)概念與介紹"><img src="https://s3.ap-northeast-1.amazonaws.com/django.blog/static/article_image/HR21KzZAddWqXVimHGkaCdAKIOYUIfb1.png" onerror="this.onerror=null;this.src='/Software-Jed/img/404.jpg'" alt="陣列(Array)概念與介紹"/></a><div class="content"><a class="title" href="/Software-Jed/2025/02/04/%E9%99%A3%E5%88%97-Array-%E6%A6%82%E5%BF%B5%E8%88%87%E4%BB%8B%E7%B4%B9/" title="陣列(Array)概念與介紹">陣列(Array)概念與介紹</a><time datetime="2025-02-04T09:37:45.398Z" title="Created 2025-02-04 17:37:45">2025-02-04</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By Jed Hung</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.3</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/Software-Jed/js/utils.js?v=5.5.3"></script><script src="/Software-Jed/js/main.js?v=5.5.3"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const config = mermaidSrc.dataset.config ? JSON.parse(mermaidSrc.dataset.config) : {}
      if (!config.theme) {
        config.theme = theme
      }
      const mermaidThemeConfig = `%%{init: ${JSON.stringify(config)}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid@11.12.2/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>